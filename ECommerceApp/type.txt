AUTHENTICATION CLASS
/*
 * Authentication.java
 *
 * Created on October 24, 2007, 4:52 PM
 */

package UI;
import java.util.*;
import javax.swing.JOptionPane;
/**
 *
 * @author  Administrator
 */
public class Authentication extends javax.swing.JFrame {
    long totaltime;
    long starttime;
    long stoptime;
    long keypressed;
    long keyreleased;
    String pt;
    String ikt;
    ArrayList<Long> presstime;
    ArrayList<Long> interkeytime;
    passwordverification.UserBean ub; 
    passwordverification.PasswordVerificationDAO dao;
    identification.IdentificationDAO idao;
    /** Creates new form Authentication */
    public Authentication() {
        presstime = new ArrayList();
        interkeytime = new ArrayList();
        ub = new passwordverification.UserBean();
        dao = new passwordverification.PasswordVerificationDAO();
        idao = new identification.IdentificationDAO();
     initComponents();
        
    }
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jtfun = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jpwfpw = new javax.swing.JPasswordField();
        btnauthenticate = new javax.swing.JButton();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jtfpt = new javax.swing.JTextField();
        jtfikt = new javax.swing.JTextField();
        jtftt = new javax.swing.JTextField();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("Secure Login");

        jLabel1.setText("UserID :");

        jLabel2.setText("Password :");

        jpwfpw.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jpwfpwFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                jpwfpwFocusLost(evt);
            }
        });
        jpwfpw.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jpwfpwKeyPressed(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                jpwfpwKeyReleased(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                jpwfpwKeyTyped(evt);
            }
        });

        btnauthenticate.setText("Authenticate");
        btnauthenticate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnauthenticateActionPerformed(evt);
            }
        });

        jLabel3.setFont(new java.awt.Font("Tahoma", 0, 36));
        jLabel3.setText("Secure Login");

        jLabel4.setText("Press Time: ");

        jLabel5.setText("Inter Key Time: ");

        jLabel6.setText("Total Time: ");

        jtfpt.setEditable(false);
        jtfpt.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtfptActionPerformed(evt);
            }
        });
        jtfikt.setEditable(false);
        jtftt.setEditable(false);
        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel4)
                            .addComponent(jLabel5)
                            .addComponent(jLabel6))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jtfikt, javax.swing.GroupLayout.DEFAULT_SIZE, 199, Short.MAX_VALUE)
                            .addComponent(jtftt, javax.swing.GroupLayout.DEFAULT_SIZE, 199, Short.MAX_VALUE)
                            .addComponent(jtfpt, javax.swing.GroupLayout.DEFAULT_SIZE, 199, Short.MAX_VALUE)))
                    .addComponent(jLabel3)
                    .addGroup(layout.createSequentialGroup()
      
                  .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel1)
                            .addComponent(jLabel2))
                        .addGap(55, 55, 55)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(btnauthenticate)
                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                .addComponent(jpwfpw)
                                .addComponent(jtfun, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                .addGap(20, 20, 20))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jLabel3)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jtfun, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel1))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel2)
                    .addComponent(jpwfpw, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnauthenticate)
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel4)
                    .addComponent(jtfpt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel5)
                    .addComponent(jtfikt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel6)
                    .addComponent(jtftt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

private void jpwfpwKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jpwfpwKeyPressed
   

 // TODO add your handling code here:
      interkeytime.add(new java.util.Date().getTime() - keypressed);
      keypressed = new java.util.Date().getTime();
}//GEN-LAST:event_jpwfpwKeyPressed

private void jpwfpwKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jpwfpwKeyReleased
    // TODO add your handling code here:
     keyreleased = new java.util.Date().getTime();
     presstime.add(keyreleased - keypressed);
}//GEN-LAST:event_jpwfpwKeyReleased

private void jpwfpwKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jpwfpwKeyTyped
    // TODO add your handling code here:  
}//GEN-LAST:event_jpwfpwKeyTyped
private void btnauthenticateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnauthenticateActionPerformed
    // TODO add your handling code here:
    this.setEnabled(false);
    if(jtfun.getText().equals("admin") && jtfun.getText().equals("admin")) {
        AdminPanel ap = new AdminPanel();
        ap.setVisible(true);
        ap.setEnabled(true);
        this.dispose();
        return; 
    }
   
 ub.setInterkeytime(interkeytime);
    ub.setPresstime(presstime);
    ub.setTotaltime(totaltime);
    ub.setUN(jtfun.getText());
    ub.setPW(jpwfpw.getText());
    try{   
     if(dao.check(ub)){
        System.out.println("Password Verification Complete....");
        if(idao.identify(ub)) {
            this.dispose();
            new NewsReporting().setVisible(true);
        }
        else
            JOptionPane.showMessageDialog(this, "Typing Pattern Mismatch...","Login",2);
     }
     else {
         System.out.println("Password Verfication Failed...");
         JOptionPane.showMessageDialog(this,"Password Verification Failed....","Login",2);
     }
   }
    catch(Exception e){
        e.printStackTrace();
    }    
}//GEN-LAST:event_btnauthenticateActionPerformed
private void jtfptActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtfptActionPerformed
    // TODO add your handling code here:
}//GEN-LAST:event_jtfptActionPerformed

private void jpwfpwFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jpwfpwFocusGained
    // TODO add your handling code here:
    pt=ikt="";
    starttime = keypressed =  new java.util.Date().getTime();
}//GEN-LAST:event_jpwfpwFocusGained

private void jpwfpwFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jpwfpwFocusLost
    // TODO add your handling code here:
    stoptime = new java.util.Date().getTime();
        totaltime = stoptime - starttime;
       for(Long l: presstime)
        {
            pt+=l.toString();
            pt+=",";
        }
        for(Long l: interkeytime){
            ikt+=l.toString();
            ikt+=",";
        }
        jtfpt.setText(pt);
        jtfikt.setText(ikt);
        jtftt.setText(new Long(totaltime).toString());
}//GEN-LAST:event_jpwfpwFocusLost
    
  
  /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new Authentication().setVisible(true);
            }
        });
    }
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnauthenticate;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JPasswordField jpwfpw;
    private javax.swing.JTextField jtfikt;
    private javax.swing.JTextField jtfpt;
    private javax.swing.JTextField jtftt;
    private javax.swing.JTextField jtfun;
    // End of variables declaration//GEN-END:variables
    
}
OKDIALOG CLASS
/*
 * OkCancelDialog.java
 *
 * Created on October 30, 2007, 3:47 PM
 */
package UI;
/**
 *
 * @author  Administrator
 */
public class OkDialog extends javax.swing.JFrame {
    String title;
    String message;
    /** Creates new form OkCancelDialog */
    public OkDialog(){
            initComponents();
    }
    public OkDialog(String title, String message) {
        super(title);
        this.title = title;
        this.message = message;
        initComponents();
        lblmessage.setText(message);
        this.setVisible(true);
    }
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        lblmessage = new javax.swing.JLabel();
        jButton1 = new javax.swing.JButton();
 setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE); lblmessage.setFont(new java.awt.Font("Tahoma", 0, 18));
        jButton1.setText("Ok");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
             .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(lblmessage, javax.swing.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE))
                    .addGroup(layout.createSequentialGroup()
                        .addGap(67, 67, 67)
                        .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 255, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(36, 36, 36)
                .addComponent(lblmessage, javax.swing.GroupLayout.PREFERRED_SIZE, 118, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jButton1)
                .addContainerGap(28, Short.MAX_VALUE))
        );
       pack();
    }// </editor-fold>//GEN-END:initComponents
   private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        // TODO add your handling code here:
        this.dispose();
    }//GEN-LAST:event_jButton1ActionPerformed
   
    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new OkDialog().setVisible(true);
            }
        });
    }










